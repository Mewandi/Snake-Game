import pygame, sys, time, random
from pygame.surfarray import array3d



Black = pygame.Color(0, 0, 0)
White = pygame.Color(255, 255, 255)
Red = pygame.Color(255, 0, 0)
Green = pygame.Color(0, 255, 0)
Gray = pygame.Color(128, 128, 128)
Purple = pygame.Color(128, 0, 128)

class SnakeEnv():
    def __init__(self, frame_size_x, frame_size_y):
        self.frame_size_x = frame_size_x
        self.frame_size_y = frame_size_y
        self.game_window = pygame.display.set_mode((self.frame_size_x, self.frame_size_y))
        self.stage = 1
        self.life = 3
        self.reset()

    def reset(self):

        self.game_window.fill(Black)
        self.snake_pos = [100, 50]
        self.snake_body = [[100, 50], [90, 50], [80, 50]]
        self.danger_snake_pos = [50, 560]
        self.danger_snake_body = [[50, 560], [60, 560], [70, 560]]



        if self.stage == 1 or self.stage == 9:
            self.bar = [



            ]
        elif self.stage == 2 or self.stage == 10:
            self.bar = [
                            [140, 170], [150, 170], [160, 170], [170, 170], [180, 170], [190, 170], [200, 170], [210, 170],
                            [220, 170], [230, 170], [240, 170], [250, 170], [260, 170], [270, 170], [280, 170], [290, 170],
                            [300, 170], [310, 170], [320, 170], [330, 170], [340, 170], [350, 170], [360, 170], [370, 170],
                            [380, 170], [390, 170], [400, 170], [410, 170], [420, 170], [430, 170], [440, 170], [450, 170],
                            [460, 170], [470, 170],

                            [140, 400], [150, 400], [160, 400], [170, 400], [180, 400], [190, 400], [200, 400], [210, 400],
                            [220, 400], [230, 400], [240, 400], [250, 400], [260, 400], [270, 400], [280, 400], [290, 400],
                            [300, 400], [310, 400], [320, 400], [330, 400], [340, 400], [350, 400], [360, 400], [370, 400],
                            [380, 400], [390, 400], [400, 400], [410, 400], [420, 400], [430, 400], [440, 400], [450, 400],
                            [460, 400], [470, 400],

                        ]

        elif self.stage == 3 or self.stage == 11:
            self.bar = [
                            [0, 70], [10, 70], [30, 70], [40, 70], [50, 70], [60, 70], [70, 70], [80, 70], [90, 70], [100, 70],
                            [110, 70], [120, 70], [130, 70], [140, 70], [150, 70], [160, 70], [170, 70], [180, 70], [190, 70],
                            [200, 70],
                            [210, 70], [220, 70], [230, 70], [240, 70], [250, 70], [260, 70], [270, 70], [280, 70], [290, 70],
                            [300, 70],
                            [310, 70], [320, 70], [330, 70], [350, 70], [360, 70], [370, 70], [380, 70], [390, 70], [400, 70],
                            [410, 70], [420, 70], [430, 70], [440, 70], [450, 70], [460, 70], [470, 70], [480, 70], [490, 70],
                            [500, 70],
                            [510, 70], [520, 70], [530, 70], [540, 70], [550, 70], [560, 70], [570, 70], [590, 70], [600, 70],

                            [0, 120], [10, 120], [20, 120], [30, 120], [40, 120], [50, 120], [60, 120], [70, 120], [80, 120],
                            [90, 120], [100, 120],
                            [110, 120], [130, 120], [140, 120], [150, 120], [160, 120], [170, 120], [180, 120], [190, 120],
                            [200, 120],
                            [210, 120], [220, 120], [230, 120], [240, 120], [250, 120], [270, 120], [280, 120], [290, 120],
                            [300, 120],
                            [310, 120], [320, 120], [330, 120], [340, 120], [350, 120], [360, 120], [370, 120], [380, 120],
                            [390, 120], [400, 120],
                            [410, 120], [420, 120], [430, 120], [440, 120], [450, 120], [460, 120], [480, 120], [490, 120],
                            [500, 120],
                            [510, 120], [520, 120], [530, 120], [540, 120], [550, 120], [560, 120], [570, 120], [580, 120],
                            [590, 120], [600, 120],

                            [0, 170], [10, 170], [20, 170], [30, 170], [40, 170], [50, 170], [60, 170], [70, 170], [80, 170],
                            [90, 170], [100, 170],
                            [110, 170], [120, 170], [130, 170], [140, 170], [150, 170], [160, 170], [170, 170], [180, 170],
                            [190, 170], [200, 170],
                            [210, 170], [230, 170], [240, 170], [250, 170], [260, 170], [270, 170], [280, 170], [290, 170],
                            [300, 170],
                            [310, 170], [320, 170], [330, 170], [340, 170], [350, 170], [360, 170], [370, 170], [380, 170],
                            [390, 170], [400, 170],
                            [410, 170], [420, 170], [430, 170], [440, 170], [450, 170], [460, 170], [470, 170], [480, 170],
                            [490, 170], [500, 170],
                            [510, 170], [520, 170], [530, 170], [540, 170], [550, 170], [560, 170], [570, 170], [590, 170],
                            [600, 170],

                            [10, 220], [20, 220], [30, 220], [40, 220], [50, 220], [60, 220], [70, 220], [80, 220], [90, 220],
                            [100, 220],
                            [110, 220], [120, 220], [130, 220], [140, 220], [150, 220], [160, 220], [170, 220], [180, 220],
                            [190, 220], [200, 220],
                            [210, 220], [220, 220], [240, 220], [250, 220], [260, 220], [270, 220], [280, 220], [290, 220],
                            [300, 220],
                            [310, 220], [320, 220], [330, 220], [340, 220], [350, 220], [360, 220], [370, 220], [380, 220],
                            [390, 220], [400, 220],
                            [410, 220], [420, 220], [430, 220], [440, 220], [460, 220], [470, 220], [480, 220], [490, 220],
                            [500, 220],
                            [510, 220], [520, 220], [530, 220], [540, 220], [550, 220], [560, 220], [570, 220], [580, 220],
                            [590, 220], [600, 220],

                            [0, 270], [10, 270], [20, 270], [30, 270], [40, 270], [50, 270], [60, 270], [70, 270], [80, 270],
                            [90, 270], [100, 270],
                            [110, 270], [120, 270], [130, 270], [140, 270], [150, 270], [160, 270], [170, 270], [180, 270],
                            [190, 270], [200, 270],
                            [210, 270], [230, 270], [240, 270], [250, 270], [260, 270], [270, 270], [280, 270], [290, 270],
                            [300, 270],
                            [310, 270], [320, 270], [330, 270], [340, 270], [350, 270], [360, 270], [370, 270], [380, 270],
                            [390, 270], [400, 270],
                            [410, 270], [420, 270], [430, 270], [440, 270], [450, 270], [460, 270], [470, 270], [480, 270],
                            [490, 270], [500, 270],
                            [510, 270], [520, 270], [530, 270], [540, 270], [550, 270], [560, 270], [570, 270], [580, 270],
                            [590, 270],

                            [0, 320], [10, 320], [20, 320], [30, 320], [40, 320], [50, 320], [60, 320], [70, 320], [80, 320],
                            [90, 320], [100, 320],
                            [120, 320], [130, 320], [140, 320], [150, 320], [160, 320], [170, 320], [180, 320], [190, 320],
                            [200, 320],
                            [210, 320], [220, 320], [230, 320], [240, 320], [250, 320], [260, 320], [270, 320], [280, 320],
                            [290, 320], [300, 320],
                            [310, 320], [320, 320], [330, 320], [340, 320], [350, 320], [360, 320], [370, 320], [380, 320],
                            [390, 320], [400, 320],
                            [410, 320], [420, 320], [440, 320], [450, 320], [460, 320], [470, 320], [480, 320], [490, 320],
                            [500, 320],
                            [510, 320], [520, 320], [530, 320], [540, 320], [550, 320], [560, 320], [570, 320], [580, 320],
                            [590, 320], [600, 320],

                            [0, 370], [10, 370], [20, 370], [30, 370], [40, 370], [50, 370], [60, 370], [70, 370], [80, 370],
                            [100, 370],
                            [110, 370], [120, 370], [130, 370], [140, 370], [150, 370], [160, 370], [170, 370], [180, 370],
                            [190, 370], [200, 370],
                            [210, 370], [220, 370], [230, 370], [240, 370], [250, 370], [260, 370], [270, 370], [280, 370],
                            [290, 370], [300, 370],
                            [310, 370], [320, 370], [330, 370], [340, 370], [350, 370], [360, 370], [370, 370], [380, 370],
                            [390, 370], [400, 370],
                            [410, 370], [420, 370], [430, 370], [440, 370], [450, 370], [460, 370], [470, 370], [480, 370],
                            [490, 370], [500, 370],
                            [510, 370], [520, 370], [530, 370], [540, 370], [550, 370], [560, 370], [570, 370], [590, 370],
                            [600, 370],

                            [0, 420], [20, 420], [30, 420], [40, 420], [50, 420], [60, 420], [70, 420], [80, 420], [90, 420],
                            [100, 420],
                            [110, 420], [120, 420], [130, 420], [140, 420], [150, 420], [160, 420], [170, 420], [180, 420],
                            [190, 420], [200, 420],
                            [210, 420], [220, 420], [230, 420], [240, 420], [250, 420], [260, 420], [270, 420], [280, 420],
                            [290, 420], [300, 420],
                            [310, 420], [320, 420], [330, 420], [350, 420], [360, 420], [370, 420], [380, 420], [390, 420],
                            [400, 420],
                            [410, 420], [420, 420], [430, 420], [440, 420], [450, 420], [460, 420], [470, 420], [480, 420],
                            [490, 420], [500, 420],
                            [510, 420], [520, 420], [530, 420], [540, 420], [550, 420], [560, 420], [570, 420], [580, 420],
                            [590, 420], [600, 420],

                            [0, 470], [10, 470], [20, 470], [30, 470], [40, 470], [50, 470], [60, 470], [70, 470], [80, 470],
                            [90, 470], [100, 470],
                            [110, 470], [120, 470], [130, 470], [140, 470], [150, 470], [160, 470], [170, 470], [180, 470],
                            [190, 470], [200, 470],
                            [210, 470], [220, 470], [230, 470], [240, 470], [250, 470], [260, 470], [270, 470], [280, 470],
                            [290, 470], [300, 470],
                            [310, 470], [320, 470], [340, 470], [350, 470], [360, 470], [370, 470], [380, 470], [390, 470],
                            [400, 470],
                            [410, 470], [420, 470], [430, 470], [440, 470], [450, 470], [460, 470], [470, 470], [490, 470],
                            [500, 470],
                            [510, 470], [520, 470], [530, 470], [540, 470], [550, 470], [560, 470], [570, 470], [580, 470],
                            [590, 470], [600, 470],

                            [0, 520], [10, 520], [20, 520], [30, 520], [40, 520], [50, 520], [60, 520], [70, 520], [80, 520],
                            [90, 520], [100, 520],
                            [120, 520], [130, 520], [140, 520], [150, 520], [160, 520], [170, 520], [180, 520], [190, 520],
                            [200, 520],
                            [210, 520], [220, 520], [230, 520], [240, 520], [250, 520], [260, 520], [270, 520], [280, 520],
                            [290, 520], [300, 520],
                            [310, 520], [320, 520], [330, 520], [340, 520], [350, 520], [360, 520], [370, 520], [380, 520],
                            [390, 520], [400, 520],
                            [410, 520], [420, 520], [430, 520], [440, 520], [450, 520], [460, 520], [470, 520], [480, 520],
                            [500, 520],
                            [510, 520], [520, 520], [530, 520], [540, 520], [550, 520], [560, 520], [570, 520], [580, 520],
                            [590, 520], [600, 520],
                        ]


        elif self.stage == 4 or self.stage == 12:
            self.bar = [
                             [40,70],[50,70],[60,70],[70,70],[80,70],[90,70],[100,70],[110,70],[120,70],[130,70],
                             [40,70],[40,80],[40,90],[40,100],[40,110],[40,120],[40,130],[40,140],[40,150],[40,160],
                             [440,70],[450,70],[460,70],[470,70],[480,70],[490,70],[500,70],[510,70],[520,70],[530,70],
                             [530,70],[530,80],[530,90],[530,100],[530,110],[530,120],[530,130],[530,140],[530,150],[530,160],

                             [40,400],[40,410],[40,420],[40,430],[40,440],[40,450],[40,460],[40,470],[40,480],[40,490],
                             [40,490],[50,490],[60,490],[70,490],[80,490],[90,490],[100,490],[110,490],[120,490],[130,490],
                             [530,400],[530,410],[530,420],[530,430],[530,440],[530,450],[530,460],[530,470],[530,480],[530,490],
                             [440,490],[450,490],[460,490],[470, 490],[480,490],[490,490],[500,490],[510,490],[520,490],[530,490],

                             [140,170],[150,170],[160,170],[170,170],[180,170],[190,170],[200,170],[210,170],[220,170],[230,170],
                             [240,170],[250,170],[260,170],[270,170],[280,170],[290,170],[300,170],[310,170],[320,170],[330,170],
                             [340,170],[350,170],[360,170],[370,170],[380,170],[390,170],[400,170],[410,170],[420,170],[430,170],
                             [440,170],[450,170],[460,170],[470,170],

                             [140,400],[150,400],[160,400],[170,400],[180,400],[190,400],[200,400],[210,400],[220,400],[230,400],
                             [240,400],[250,400],[260,400],[270,400],[280,400],[290,400],[300,400],[310,400],[320,400],[330,400],
                             [340,400],[350,400],[360,400],[370,400],[380,400],[390,400],[400,400],[410,400],[420,400],[430,400],
                             [440,400],[450,400],[460,400],[470,400],
                        ]

        elif self.stage == 5 or self.stage == 13:
            self.bar = [
                            [40,90],[50,90],[60,90],[70,90],[80,90],[90,90],[100,90],[110,90],[120,90],[130,90],
                            [140,90],[150,90],[160,90],[170,90],[180,90],[190,90],[200,90],[210,90],[220,90],[230,90],
                            [240,90],[250,90],[260,90],[270,90],[300,90],[310,90],[320,90],[330,90],[340,90],[350,90],
                            [360,90],[370,90],[380,90],[390,90],[400,90],[410,90],[420,90],[430,90],[440,90],[450,90],
                            [460,90],[470,90],[480,90],[490,90],[500,90],[510,90],[520,90],[530,90],[540,90],

                            [40,550],[50,550],[60,550],[70,550],[80,550],[90,550],[100,550],[110,550],[120,550],
                            [130,550],[140,550],[150,550],[160,550],[170,550],[180,550],[190,550],[200,550],[210,550],
                            [220,550],[230,550],[240,550],[250,550],[260,550],[270,550],[300,550],[310,550],[320,550],
                            [330,550],[340,550],[350,550],[360,550],[370,550],[380,550],[390,550],[400,550],[410,550],
                            [420,550],[430,550],[440,550],[450,550],[460,550],[470,550],[480,550],[490,550],[500,550],
                            [510,550],[520,550],[530,550],[540,550],

                            [40,120],[40,130],[40,140],[40,150],[40,160],[40,170],[40,180],[40,190],[40,200],[40,210],
                            [40,220],[40,230],[40,240],[40,250],[40,260],[40,270],[40,280],[40,290],[40,300],[40,310],
                            [40,320],[40,330],[40,340],[40,350],[40,360],[40,370],[40,380],[40,390],[40,400],[40,410],
                            [40,420],[40,430],[40,440],[40,450],[40,460],[40,470],[40,480],[40,490],[40,500],[40,510],
                            [40,520],

                            [540,120],[540,130],[540,140],[540,150],[540,160],[540,170],[540,180],[540,190],[540,200],[540,210],
                            [540,220],[540,230],[540,240],[540,250],[540,260],[540,270],[540,280],[540,290],[540,300],[540,310],
                            [540,320],[540,330],[540,340],[540,350],[540,360],[540,370],[540,380],[540,390],[540,400],[540,410],
                            [540,420],[540,430],[540,440],[540,450],[540,460],[540,470],[540,480],[540,490],[540,500],[540,510],
                            [540,520],

                            [140,200],[150,200],[160,200],[170,200],[180,200],[190,200],[200,200],[210,200],[220,200],[230,200],
                            [240,200],[250,200],[260,200],[270,200],[280,200],[290,200],[300,200],[310,200],[320,200],[330,200],
                            [340,200],[350,200],[360,200],[370,200],[380,200],[390,200],[400,200],[410,200],[420,200],[430,200],
                            [440,200],[450,200],[460,200],[470,200],

                            [300,140],[300,150],[300,160],[300,170],[300,180],[300,190],[300,200],[300,210],[300,220],[300,230],
                            [300,240],[300,250],[300,260],[300,270],[300,280],[300,290],[300,300],[300,310],[300,320],[300,330],
                            [300,340],[300,350],[300,360],[300,370],[300,380],[300,390],[300,400],[300,410],[300,420],[300,430],
                            [300,440],[300,450],[300,460],[300,470],

                            [140,400],[150,400],[160,400],[170,400],[180,400],[190,400],[200,400],[210,400],[220,400],[230,400],
                            [240,400],[250,400],[260,400],[270,400],[280,400],[290,400],[300,400],[310,400],[320,400],[330,400],
                            [340,400],[350,400],[360,400],[370,400],[380,400],[390,400],[400,400],[410,400],[420,400],[430,400],
                            [440,400],[450,400],[460,400],[470,400],

                        ]

        elif self.stage == 6 or self.stage == 14:
            self.bar = [
                            [10, 90], [20, 90], [30, 90], [40, 90], [50, 90], [60, 90], [70, 90], [100, 90], [110, 90], [120, 90],
                            [130, 90],
                            [140, 90], [150, 90], [160, 90], [170, 90], [180, 90], [190, 90], [200, 90], [210, 90], [220, 90],
                            [230, 90],
                            [240, 90], [250, 90], [260, 90], [270, 90], [280, 90], [290, 90], [300, 90], [310, 90], [320, 90],
                            [330, 90],
                            [340, 90], [350, 90], [360, 90], [370, 90], [380, 90], [390, 90], [400, 90], [410, 90], [420, 90],
                            [430, 90], [440, 90], [450, 90],
                            [460, 90], [470, 90], [480, 90], [490, 90], [500, 90], [510, 90], [520, 90], [530, 90], [540, 90],
                            [550, 90], [580, 90], [590, 90], [600, 90],

                            [0, 140], [10, 140], [20, 140], [30, 140], [40, 140], [50, 140], [60, 140], [70, 140], [80, 140],
                            [90, 140], [100, 140],
                            [110, 140], [120, 140],
                            [130, 140], [140, 140], [150, 140], [160, 140], [170, 140], [180, 140], [190, 140], [200, 140],
                            [210, 140],
                            [220, 140], [230, 140], [240, 140], [250, 140], [260, 140],
                            [270, 140], [280, 140], [340, 140], [350, 140], [360, 140], [370, 140],
                            [380, 140], [390, 140], [400, 140], [410, 140], [420, 140],
                            [430, 140], [440, 140], [450, 140], [460, 140], [470, 140],
                            [480, 140], [490, 140], [500, 140], [510, 140], [520, 140], [530, 140],
                            [540, 140], [550, 140], [560, 140], [570, 140], [580, 140], [590, 140],

                            [100, 70], [100, 80], [100, 90], [100, 100], [100, 130], [100, 140],
                            [100, 150], [100, 160], [100, 170], [100, 200], [100, 210], [100, 220],
                            [100, 230], [100, 240], [100, 250], [100, 260], [100, 270], [100, 280], [100, 290], [100, 300],
                            [100, 310], [100, 320], [100, 330], [100, 340], [100, 350], [100, 360], [100, 370], [100, 380],
                            [100, 390], [100, 400], [100, 410], [100, 440], [100, 450], [100, 460],
                            [100, 470], [100, 480], [100, 490], [100, 500], [100, 510], [100, 520], [100, 530], [100, 540],
                            [90, 210], [80, 210], [70, 210], [60, 210], [50, 210], [40, 210], [30, 210], [20, 210],
                            [90, 300], [60, 300], [50, 300], [40, 300], [30, 300], [20, 300], [10, 300], [0, 300],
                            [90, 400], [80, 400], [70, 400], [60, 400], [50, 400], [20, 400], [10, 400], [0, 400],
                            [90, 500], [60, 500], [50, 500], [40, 500], [30, 500], [20, 500], [10, 500], [0, 500],

                            [200, 70], [200, 80], [200, 90], [200, 100], [200, 130], [200, 140],
                            [200, 150], [200, 160], [200, 170], [200, 180], [200, 190], [200, 200], [200, 210], [200, 220],
                            [200, 230], [200, 240], [200, 250], [200, 260], [200, 290], [200, 300],
                            [200, 310], [200, 320], [200, 330], [200, 340], [200, 350], [200, 360], [200, 370], [200, 380],
                            [200, 390], [200, 400], [200, 410], [200, 420], [200, 430], [200, 440], [200, 450], [200, 460],
                            [200, 470], [200, 480], [200, 490], [200, 500], [200, 510], [200, 520], [200, 530], [200, 540],
                            [190, 210], [180, 210], [170, 210], [140, 210], [130, 210], [120, 210], [110, 210], [100, 210],
                            [190, 300], [180, 300], [170, 300], [160, 300], [150, 300], [140, 300], [130, 300],
                            [190, 400], [180, 400], [170, 400], [160, 400], [150, 400], [120, 400], [110, 400], [110, 400],
                            [190, 500], [160, 500], [150, 500], [140, 500], [130, 500], [120, 500], [110, 500], [110, 500],

                            [310, 70], [310, 80], [310, 90], [310, 100], [310, 130], [310, 140],
                            [310, 150], [310, 160], [310, 170], [310, 180], [310, 190], [310, 200], [310, 210], [310, 220],
                            [310, 230], [310, 240], [310, 250], [310, 260], [310, 270], [310, 280], [310, 290], [310, 300],
                            [310, 310], [310, 320], [310, 330], [310, 360], [310, 370], [310, 380],
                            [310, 390], [310, 400], [310, 410], [310, 420], [310, 430], [310, 440], [310, 450], [310, 460],
                            [310, 470], [310, 480], [310, 490], [310, 500], [310, 510], [310, 520], [310, 530], [310, 540],
                            [300, 210], [290, 210], [280, 210], [270, 210], [260, 210], [250, 210],
                            [280, 300], [270, 300], [260, 300], [250, 300], [240, 300], [230, 300], [220, 300], [210, 300],
                            [300, 400], [290, 400], [260, 400], [250, 400], [240, 400], [230, 400], [220, 400], [210, 400],
                            [300, 500], [290, 500], [280, 500], [270, 500], [260, 500], [250, 500], [240, 500], [230, 500],

                            [420, 70], [420, 80], [420, 90], [420, 100], [420, 130], [420, 140],
                            [420, 150], [420, 160], [420, 170], [420, 180], [420, 210], [420, 220],
                            [420, 230], [420, 240], [420, 250], [420, 260], [420, 270], [420, 280], [420, 290], [420, 300],
                            [420, 310], [420, 320], [420, 330], [420, 340], [420, 350], [420, 360], [420, 370], [420, 380],
                            [420, 390], [420, 400], [420, 410], [420, 420], [420, 450], [420, 460],
                            [420, 470], [420, 480], [420, 490], [420, 500], [420, 510], [420, 520], [420, 530], [420, 540],
                            [410, 230], [400, 230], [390, 230], [360, 230], [350, 230], [340, 230], [330, 230], [320, 230],
                            [410, 300], [400, 300], [390, 300], [380, 300], [370, 300], [360, 300], [350, 300], [340, 300],
                            [390, 400], [380, 400], [370, 400], [360, 400], [350, 400], [340, 400], [330, 400], [320, 400],
                            [410, 500], [400, 500], [390, 500], [380, 500], [370, 500], [360, 500], [350, 500], [340, 500],

                            [520, 70], [520, 80], [520, 90], [520, 100], [520, 130], [520, 140],
                            [520, 150], [520, 160], [520, 170], [520, 180], [520, 190], [520, 200], [520, 210], [520, 220],
                            [520, 230], [520, 240], [520, 250], [520, 280], [520, 290], [520, 300],
                            [520, 310], [520, 320], [520, 330], [520, 340], [520, 350], [520, 360], [520, 370], [520, 380],
                            [520, 390], [520, 400], [520, 410], [520, 420], [520, 430], [520, 460],
                            [520, 470], [520, 480], [520, 490], [520, 500], [520, 510], [520, 520], [520, 530], [520, 540],
                            [510, 220], [500, 220], [490, 220], [480, 220], [470, 220], [460, 220], [450, 220],
                            [510, 300], [480, 300], [470, 300], [460, 300], [450, 300], [440, 300], [430, 300], [420, 300],
                            [510, 400], [500, 400], [490, 400], [480, 400], [470, 400], [440, 400], [430, 400], [420, 400],
                            [490, 500], [480, 500], [470, 500], [460, 500], [450, 500], [440, 500], [430, 500], [420, 500],
                            [530, 350], [540, 350], [550, 350], [560, 350], [570, 350], [580, 350], [590, 350], [600, 350],

            ]

        elif self.stage == 7 or self.stage == 15:
            self.bar = [
                            [40, 90], [50, 90], [60, 90], [70, 90], [80, 90], [90, 90], [100, 90], [110, 90], [120, 90], [130, 90],
                            [140, 90], [150, 90], [160, 90], [170, 90], [180, 90], [190, 90], [200, 90], [210, 90], [220, 90],
                            [230, 90],
                            [240, 90], [250, 90], [260, 90], [270, 90], [280, 90], [290, 90], [300, 90], [310, 90], [320, 90],
                            [330, 90], [340, 90],
                            [350, 90],
                            [360, 90], [370, 90], [380, 90], [390, 90], [400, 90], [410, 90], [420, 90], [430, 90], [440, 90],
                            [450, 90],
                            [460, 90], [470, 90], [480, 90], [490, 90], [500, 90], [510, 90], [520, 90], [530, 90], [540, 90],

                            [40, 550], [50, 550], [60, 550], [70, 550], [80, 550], [90, 550], [100, 550], [110, 550], [120, 550],
                            [130, 550], [140, 550], [150, 550], [160, 550], [170, 550], [180, 550], [190, 550], [200, 550],
                            [210, 550],
                            [220, 550], [230, 550], [240, 550], [250, 550], [260, 550], [270, 550], [280, 550], [290, 550],
                            [300, 550], [310, 550],
                            [320, 550],
                            [330, 550], [340, 550], [350, 550], [360, 550], [370, 550], [380, 550], [390, 550], [400, 550],
                            [410, 550],
                            [420, 550], [430, 550], [440, 550], [450, 550], [460, 550], [470, 550], [480, 550], [490, 550],
                            [500, 550],
                            [510, 550], [520, 550], [530, 550], [540, 550], [550, 550], [560, 550], [560, 560],

                            [40, 90], [40, 100], [40, 110], [40, 120], [40, 130], [40, 140], [40, 150], [40, 160], [40, 170],
                            [40, 180], [40, 190], [40, 200],
                            [40, 210],
                            [40, 220], [40, 230], [40, 240], [40, 250], [40, 260], [40, 270], [40, 280], [40, 290], [40, 300],
                            [40, 310],
                            [40, 320], [40, 330], [40, 340], [40, 350], [40, 360], [40, 370], [40, 380], [40, 390], [40, 400],
                            [40, 410],
                            [40, 420], [40, 430], [40, 440], [40, 450], [40, 460], [40, 470], [40, 480], [40, 490], [40, 500],
                            [40, 510], [40, 520], [40, 530], [40, 540],

                            [540, 90], [540, 100], [540, 110], [540, 120], [540, 130], [540, 140], [540, 150], [540, 160],
                            [540, 170], [540, 180], [540, 190],
                            [540, 200], [540, 210],
                            [540, 220], [540, 230], [540, 240], [540, 250], [540, 260], [540, 270], [540, 280], [540, 290],
                            [540, 300], [540, 310],
                            [540, 320], [540, 330], [540, 340], [540, 350], [540, 360], [540, 370], [540, 380], [540, 390],
                            [540, 400], [540, 410],
                            [540, 420], [540, 430], [540, 440], [540, 450], [540, 460], [540, 470], [540, 480], [540, 490],
                            [540, 500], [540, 510], [540, 520], [550, 520], [560, 520], [570, 520], [580, 520], [590, 520],
                            [590, 530], [590, 540], [590, 550], [590, 560],

                            [110, 90], [110, 100], [110, 110], [110, 120], [110, 130],
                            [110, 170], [110, 180], [110, 190], [110, 200], [110, 210], [110, 220], [110, 230], [110, 240],
                            [110, 280], [110, 290], [110, 300], [110, 310], [110, 320],
                            [110, 330], [110, 340], [110, 380], [110, 390], [110, 400],
                            [110, 410], [110, 420], [110, 430], [110, 440], [110, 470], [110, 480],
                            [110, 490], [110, 500], [110, 510], [110, 520], [110, 530], [110, 540],

                            [200, 90], [200, 100], [200, 140], [200, 150], [200, 160],
                            [200, 170], [200, 180], [200, 190], [200, 200], [200, 210],
                            [200, 250], [200, 260], [200, 270], [200, 280], [200, 290], [200, 300], [200, 310], [200, 320],
                            [200, 330], [200, 340], [200, 380], [200, 390], [200, 400],
                            [200, 410], [200, 440], [200, 450], [200, 460], [200, 470], [200, 480],
                            [200, 490], [200, 500], [200, 510], [200, 520], [200, 530], [200, 540],

                            [300, 90], [300, 100], [300, 110], [300, 120], [300, 130], [300, 140], [300, 150],
                            [300, 190], [300, 200], [300, 210], [300, 220], [300, 230], [300, 240],
                            [300, 250], [300, 290], [300, 300], [300, 310], [300, 320],
                            [300, 330], [300, 340], [300, 380], [300, 390], [300, 400],
                            [300, 410], [300, 420], [300, 430], [300, 460], [300, 470], [300, 480],
                            [300, 490], [300, 500], [300, 510], [300, 520], [300, 530], [300, 540],

                            [400, 90], [400, 100], [400, 110], [400, 150], [400, 160],
                            [400, 170], [400, 180], [400, 190], [400, 200], [400, 210],
                            [400, 250], [400, 260], [400, 270], [400, 280], [400, 290], [400, 300], [400, 310], [400, 320],
                            [400, 330], [400, 340], [400, 350], [400, 390], [400, 400],
                            [400, 410], [400, 420], [400, 460], [400, 470], [400, 480], [400, 490], [400, 500], [400, 510],
                            [400, 520], [400, 530], [400, 540],

                            [50, 200], [60, 200], [70, 200], [80, 200], [90, 200], [100, 200], [110, 200], [120, 200], [130, 200],
                            [140, 200], [150, 200], [160, 200], [170, 200], [180, 200], [190, 200], [200, 200], [210, 200],
                            [220, 200], [230, 200], [270, 200], [280, 200], [290, 200],
                            [300, 200], [310, 200], [320, 200], [330, 200], [340, 200], [350, 200], [360, 200], [370, 200],
                            [380, 200], [390, 200], [400, 200], [410, 200], [420, 200], [430, 200], [440, 200], [450, 200],
                            [460, 200], [470, 200], [480, 200], [490, 200], [500, 200], [510, 200], [520, 200], [530, 200],

                            [50, 300], [90, 300], [100, 300], [110, 300], [120, 300], [130, 300],
                            [140, 300], [150, 300], [160, 300], [170, 300], [180, 300], [190, 300], [200, 300], [210, 300],
                            [220, 300], [230, 300], [270, 300], [280, 300], [290, 300],
                            [300, 300], [310, 300], [320, 300], [330, 300], [340, 300], [350, 300], [360, 300], [370, 300],
                            [380, 300], [390, 300], [400, 300], [410, 300], [420, 300], [430, 300], [440, 300], [450, 300],
                            [460, 300], [500, 300], [510, 300], [520, 300], [530, 300],

                            [50, 400], [60, 400], [70, 400], [80, 400], [90, 400], [100, 400], [110, 400], [120, 400], [130, 400],
                            [140, 400], [150, 400], [180, 400], [190, 400], [200, 400], [210, 400],
                            [220, 400], [230, 400], [240, 400], [250, 400], [260, 400], [270, 400], [280, 400], [290, 400],
                            [300, 400], [310, 400], [320, 400], [330, 400], [340, 400], [370, 400],
                            [380, 400], [390, 400], [400, 400], [410, 400], [420, 400], [430, 400], [440, 400], [450, 400],
                            [460, 400], [470, 400], [480, 400], [490, 400], [500, 400], [510, 400], [520, 400], [530, 400],

                            [50, 470], [60, 470], [70, 470], [100, 470], [110, 470], [120, 470], [130, 470],[140, 470],
                            [170, 470], [180, 470], [190, 470], [200, 470], [210, 470],[220, 470], [230, 470],[240, 470],
                            [270, 470], [280, 470], [290, 470],[300, 470], [310, 470], [320, 470], [350, 470], [360, 470],
                            [370, 470],[380, 470], [390, 470], [400, 470], [410, 470], [420, 470], [430, 470], [440, 470],
                            [450, 470], [460, 470], [470, 470], [500, 470], [510, 470], [520, 470], [530, 470],

            ]

        elif self.stage == 8 or self.stage == 16:
            self.bar = [

                    [140, 140], [150, 150], [160, 160], [170, 170], [180, 180], [190, 190], [200, 200], [210, 210],
                    [220, 220], [230, 230], [240, 240], [250, 250], [260, 260], [270, 270], [280, 280], [290, 290],
                    [300, 300], [310, 310], [320, 320], [330, 330], [340, 340], [350, 350], [360, 360], [370, 370],
                    [380, 380], [390, 390], [400, 400], [410, 410], [420, 420], [430, 430], [440, 440], [450, 450],
                    [460, 460], [470, 470],

                    [470, 140], [460, 150], [440, 170], [430, 180], [420, 190], [410, 200], [400, 210], [390, 220],
                    [380, 230], [370, 240], [360, 250], [350, 260], [340, 270], [330, 280], [320, 290], [310, 300],
                    [300, 310],
                    [290, 320], [280, 330], [270, 340], [260, 350], [250, 360], [240, 370], [230, 380], [220, 390],
                    [210, 400],
                    [200, 410], [190, 420], [180, 430], [170, 440], [160, 450], [150, 460], [140, 470],

                    [100, 100], [110, 110], [120, 120], [130, 130], [190, 130],
                    [190, 140], [200, 140], [210, 140], [220, 140], [230, 140], [240, 140], [250, 140],
                    [260, 140], [270, 140], [280, 140], [300, 140], [310, 140], [320, 140], [330, 140], [340, 140],
                    [350, 140], [360, 140], [370, 140], [380, 140], [390, 140], [400, 140], [410, 140], [420, 140],
                    [430, 140],
                    [440, 140], [450, 140], [460, 140],

                    [240, 150], [240, 160], [240, 170], [240, 180], [240, 190], [240, 200], [240, 210], [240, 230],
                    [300, 150], [300, 160], [300, 180], [300, 190], [300, 200], [300, 210], [300, 220],
                    [300, 230], [300, 240], [300, 250], [350, 160], [350, 170],
                    [350, 210], [350, 220], [350, 180],

                    [470, 140], [470, 150], [470, 160], [470, 170], [470, 180], [470, 190], [470, 200], [470, 210],
                    [470, 220], [470, 230], [470, 240], [470, 250], [470, 260], [470, 270], [470, 280],[470, 310],
                    [470, 320], [470, 330], [470, 340], [470, 350], [470, 360], [470, 370], [470, 380],[470, 390],
                    [470, 400], [470, 410], [470, 420], [470, 430], [470, 440], [470, 450], [470, 460],[360, 320],
                    [370, 320], [380, 320], [390, 320], [400, 320], [410, 320], [420, 320], [430, 320],[460, 320],
                    [420, 330], [420, 340], [420, 350], [420, 360], [390, 260], [400, 260], [410, 260],[420, 260],
                    [430, 260], [440, 260], [450, 260], [460, 260], [400, 270], [400, 280], [400, 300],[400, 310],

                    [480, 170], [490, 170], [520, 170], [530, 170], [540, 170], [550, 170],
                    [560, 170], [570, 170], [580, 170], [590, 170], [600, 170],
                    [530, 180], [530, 190], [530, 200], [530, 230], [530, 240], [530, 250],

                    [480, 260], [490, 260], [500, 260], [510, 260], [520, 260], [530, 260], [540, 260], [550, 260],
                    [560, 260], [570, 260],
                    [540, 270], [540, 280], [540, 290], [540, 300], [540, 310], [540, 320],

                    [480, 350], [490, 350], [500, 350], [510, 350], [520, 350], [530, 350], [540, 350], [550, 350],
                    [580, 350], [590, 350], [600, 350],
                    [520, 360], [520, 370], [520, 380], [520, 390], [520, 400], [520, 410], [520, 420],

                    [500, 450], [510, 450], [520, 450], [530, 450], [540, 450], [550, 450],
                    [560, 450], [570, 450], [580, 450], [590, 450], [600, 450],

                    [150, 200], [150, 210], [150, 220], [150, 230], [150, 240], [150, 250], [150, 260], [150, 270],
                    [150, 280], [150, 290], [150, 300], [150, 310], [150, 320], [150, 330], [150, 340], [150, 350],
                    [150, 360], [150, 370], [150, 380], [150, 390], [150, 400], [150, 410],

                    [140, 210], [130, 210], [120, 210], [110, 210], [100, 210], [90, 210], [80, 210],
                    [70, 210], [60, 210], [50, 210], [40, 210], [10, 210], [0, 210],
                    [50, 220], [50, 230], [50, 240], [50, 250], [50, 260], [50, 270],

                    [140, 300], [130, 300], [100, 300], [90, 300], [80, 300],
                    [70, 300], [60, 300], [50, 300], [40, 300], [30, 300], [20, 300], [10, 300], [0, 300],
                    [90, 310], [90, 320], [90, 330], [90, 340], [90, 350], [90, 360], [90, 370],

                    [140, 400], [130, 400], [120, 400], [110, 400], [100, 400], [90, 400], [80, 400],
                    [70, 400], [60, 400], [50, 400], [40, 400], [30, 400], [0, 400],
                ]

        self.food_pos = self.spawn_food()
        self.food_spawn = True
        self.direction = "Right"
        self.action = self.direction
        self.score = 0
        self.enemy_score = 0
        self.steps = 0
        print("Game Reset")

    def change_direction(self):
        if self.action == 'Up' and self.direction != 'Down':
            self.direction = 'Up'
        if self.action == 'Down' and self.direction != 'Up':
            self.direction = 'Down'
        if self.action == 'Left' and self.direction != 'Right':
            self.direction = 'Left'
        if self.action == 'Right' and self.direction != 'Left':
            self.direction = 'Right'
        return self.direction

    def move(self, direction, snake_pos):
        if direction == 'Up':
            snake_pos[1] -= 10
        if direction == 'Down':
            snake_pos[1] += 10
        if direction == 'Left':
            snake_pos[0] -= 10
        if direction == 'Right':
            snake_pos[0] += 10
        return snake_pos

    def danger_move(self):
        fx, fy = self.food_pos
        ex, ey = self.danger_snake_pos

        directions = [
            ('UP', (ex, ey - 10)),
            ('DOWN', (ex, ey + 10)),
            ('LEFT', (ex - 10, ey)),
            ('RIGHT', (ex + 10, ey)),
        ]

        # Filter out directions that hit bars



        safe_directions = [d for d in directions if list(d[1]) not in self.bar ]

        # Pick the safest direction toward food
        best_dir = None
        min_dist = float('inf')
        for dir_name, (nx, ny) in safe_directions:
            dist = abs(fx - nx) + abs(fy - ny)
            if dist < min_dist:
                min_dist = dist
                best_dir = dir_name

        # Move accordingly
        if best_dir == 'UP':
            ey -= 10
        elif best_dir == 'DOWN':
            ey += 10
        elif best_dir == 'LEFT':
            ex -= 10
        elif best_dir == 'RIGHT':
            ex += 10

        self.danger_snake_pos = [ex, ey]
        return self.danger_snake_pos

    def spawn_food(self):
        while True:
          pos = [random.randrange(1, (self.frame_size_x // 10)) * 10, random.randrange(1, (self.frame_size_y // 10)) * 10]
          if pos not in self.snake_body and pos not in self.bar:
              return pos

    def eat(self):
        return self.snake_pos[0] == self.food_pos[0] and self.snake_pos[1] == self.food_pos[1]

    def danger_eat(self):
        return self.danger_snake_pos[0] == self.food_pos[0] and self.danger_snake_pos[1] == self.food_pos[1]

    def human_step(self, event):
        action = self.action  # Default to current action

        if event.type == pygame.QUIT:
            pygame.quit()
            sys.exit()
        elif event.type == pygame.KEYDOWN:
            if event.key == pygame.K_UP:
                action = 'Up'
            if event.key == pygame.K_DOWN:
                action = 'Down'
            if event.key == pygame.K_LEFT:
                action = 'Left'
            if event.key == pygame.K_RIGHT:
                action = 'Right'
            if event.key == pygame.K_ESCAPE:
                pygame.event.post(pygame.event.Event(pygame.QUIT))

        return action

    def display_bar(self):
        # Draw bar blocks on screen
        for pos in self.bar:
            pygame.draw.rect(self.game_window, Purple, pygame.Rect(pos[0], pos[1], 10, 10))

    def display_stage(self, color, font, size):
        stage_font = pygame.font.SysFont(font, size)
        stage_surface = stage_font.render('Stage: ' + str(self.stage), True, color)
        stage_rect = stage_surface.get_rect()
        stage_rect.midtop = (500, 15)
        self.game_window.blit(stage_surface, stage_rect)

    def display_life(self, color, font, size):
        life_font = pygame.font.SysFont(font, size)
        life_surface = life_font.render('Life: ' + str(self.life), True, color)
        life_rect = life_surface.get_rect()
        life_rect.midtop = (300, 15)
        self.game_window.blit(life_surface, life_rect)

    def display_score(self, color, font, size):
        score_font = pygame.font.SysFont(font, size)
        score_surface = score_font.render('Score: ' + str(self.score), True, color)
        score_rect = score_surface.get_rect()
        score_rect.midtop = (self.frame_size_x // 10, 15)
        self.game_window.blit(score_surface, score_rect)

    def display_danger_score(self, color, font, size):
        danger_score_font = pygame.font.SysFont(font, size)
        danger_score_surface = danger_score_font.render('Enemy_Score: ' + str(self.enemy_score), True, color)
        danger_score_rect = danger_score_surface.get_rect()
        danger_score_rect.midtop = (90, 40)
        self.game_window.blit(danger_score_surface, danger_score_rect)


    def game_over(self):
        if self.snake_pos[0] < 0 or self.snake_pos[0] > self.frame_size_x - 10:
            if self.life != 0:
                self.stage
                self.life -= 1
                self.reset()
                self.score
            else:
                self.end_game()

        if self.snake_pos[1] < 0 or self.snake_pos[1] > self.frame_size_y - 10:
            if self.life != 0:
                self.stage
                self.life -= 1
                self.reset()
                self.score
            else:
                self.end_game()

        for block in self.snake_body[1:]:
            if self.snake_pos[0] == block[0] and self.snake_pos[1] == block[1]:
                if self.life != 0:
                    self.stage
                    self.life -= 1
                    self.reset()
                    self.score
                else:
                    self.end_game()

        for bar_block in self.bar:
            if self.snake_pos[0] == bar_block[0] and self.snake_pos[1] == bar_block[1]:
                if self.life != 0:
                    self.stage
                    self.life -= 1
                    self.reset()
                    self.score
                else:
                    self.end_game()

    def end_game(self):
        message = pygame.font.SysFont('arial', 20)
        message_surface = message.render("Game Has Ended:", True, Red)
        message_rect = message_surface.get_rect()
        message_rect.midtop = (self.frame_size_x // 2, self.frame_size_y // 4)
        self.game_window.fill(Black)
        self.game_window.blit(message_surface, message_rect)
        self.display_score(Red, 'times', 20,)
        pygame.display.flip()
        time.sleep(3)
        pygame.quit()
        sys.exit()


# Main Game Loop
snake_env = SnakeEnv(600, 600)
difficulty = 10
fps_controller = pygame.time.Clock()
pygame.init()
pygame.display.set_caption("Snake Game")

while True:
    for event in pygame.event.get():
        snake_env.action = snake_env.human_step(event)

    snake_env.direction = snake_env.change_direction()
    snake_env.snake_pos = snake_env.move(snake_env.direction, snake_env.snake_pos)
    snake_env.snake_body.insert(0, list(snake_env.snake_pos))

    if snake_env.stage >= 9:
        snake_env.danger_move()
        snake_env.danger_snake_body.insert(0, list(snake_env.danger_snake_pos))

    if snake_env.eat():
        snake_env.score += 1
        snake_env.food_spawn = False
        if snake_env.score == 10:
             snake_env.stage += 1
             snake_env.reset()
             snake_env.score = 0
    else:
        snake_env.snake_body.pop()

    if snake_env.stage >= 10:
        if snake_env.danger_eat():
            snake_env.enemy_score += 1
            snake_env.food_spawn = False

            if snake_env.enemy_score == 10:
                if snake_env.life != 0:
                     snake_env.stage
                     snake_env.life -= 1
                     snake_env.reset()
                     snake_env.score
                else:
                     snake_env.end_game()
        else:
            snake_env.danger_snake_body.pop()


    if not snake_env.food_spawn:
        snake_env.food_pos = snake_env.spawn_food()
    snake_env.food_spawn = True

    snake_env.game_window.fill(Black)
    for pos in snake_env.snake_body:
        pygame.draw.rect(snake_env.game_window, Green, pygame.Rect(pos[0], pos[1], 10, 10))

    if snake_env.stage >= 9:
        for pos1 in snake_env.danger_snake_body:
            pygame.draw.rect(snake_env.game_window, Red, pygame.Rect(pos1[0], pos1[1], 10, 10))

    pygame.draw.rect(snake_env.game_window, White,
                     pygame.Rect(snake_env.food_pos[0], snake_env.food_pos[1], 10, 10))

    snake_env.display_stage(Gray, 'consolas', 20)
    snake_env.display_life(Gray, 'consolas', 20)
    snake_env.display_bar()
    snake_env.game_over()
    snake_env.display_score(Gray, 'consolas', 20)
    if snake_env.stage >= 9:
      snake_env.display_danger_score(Red, 'consolas', 20, )
    pygame.display.update()
    fps_controller.tick(difficulty)
    img = array3d(snake_env.game_window)


if '__name__' == '__main__':
    main()